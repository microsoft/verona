(class
  ()
  []
  ()
  [
    (class
      $module-0
      []
      ()
      [
        (using (typeref [ (modulename $module-1 []) ]))
        (class U32 [] () [])
        (class List [ (typeparam T () ()) ] () [])
        (function
          for_sum
          []
          [
            (param
              x
              (typeref [ (typename List [ (typeref [ (typename U32 []) ]) ]) ])
              ())
          ]
          (typeref [ (typename U32 []) ])
          (lambda
            []
            []
            [
              (assign
                (oftype (var sum) (typeref [ (typename U32 []) ]))
                (int 0))
              (select
                (select
                  (select
                    ()
                    [ (typename for []) ]
                    (select () [ (typename values []) ] (ref x)))
                  [ (typename apply []) ]
                  (lambda
                    []
                    [ (param a () ()) ]
                    [
                      (assign
                        (ref sum)
                        (select (ref sum) [ (typename + []) ] (ref a)))
                    ]))
                [ (typename apply []) ]
                (ref sum))
            ]))
        (function
          while_sum
          []
          [
            (param
              x
              (typeref [ (typename List [ (typeref [ (typename U32 []) ]) ]) ])
              ())
          ]
          (typeref [ (typename U32 []) ])
          (lambda
            []
            []
            [
              (assign
                (oftype (var sum) (typeref [ (typename U32 []) ]))
                (int 0))
              (assign
                (let iter)
                (select (ref x) [ (typename values []) ] (tuple [])))
              (select
                (select
                  (select
                    ()
                    [ (typename while []) ]
                    (lambda
                      []
                      []
                      [
                        (select
                          (ref iter)
                          [ (typename has_value []) ]
                          (tuple []))
                      ]))
                  [ (typename apply []) ]
                  (lambda
                    []
                    []
                    [
                      (assign
                        (let a)
                        (select (ref iter) [ (typename apply []) ] (tuple [])))
                      (select () [ (typename next []) ] (ref iter))
                      (assign
                        (ref sum)
                        (select (ref sum) [ (typename + []) ] (ref a)))
                    ]))
                [ (typename apply []) ]
                (ref sum))
            ]))
      ])
    (class
      $module-1
      []
      ()
      [
        (function
          for
          [
            (typeparam L () (typeref [ (typename NoLabel []) ]))
            (typeparam T () ())
            (typeparam U () ())
            (typeparam V () ())
          ]
          [
            (param
              iter
              (typeref
                [ (typename Iterator [ (typeref [ (typename T []) ]) ]) ])
              ())
            (param
              body
              (functiontype
                (typeref [ (typename T []) ])
                (uniontype
                  [
                    (typeref [ (typename U []) ])
                    (throwtype (typeref [ (typename V []) ]))
                  ]))
              ())
          ]
          (uniontype
            [
              (typeref [ (typename Done [ (typeref [ (typename None []) ]) ]) ])
              (throwtype (typeref [ (typename V []) ]))
            ])
          (lambda
            []
            []
            [
              (select
                (select
                  ()
                  [ (typename while []) ]
                  (lambda [] [] [ (true true) ]))
                [ (typename apply []) ]
                (lambda
                  []
                  []
                  [
                    (try
                      (lambda
                        []
                        []
                        [
                          (select
                            (ref body)
                            [ (typename apply []) ]
                            (select
                              (ref iter)
                              [ (typename apply []) ]
                              (tuple [])))
                          (select
                            ()
                            [ (typename continue []) (typename create []) ]
                            ())
                        ])
                      [
                        (lambda
                          []
                          [
                            (select
                              (select
                                (select
                                  ()
                                  [
                                    (typename
                                      Break
                                      [ (typeref [ (typename L []) ]) ])
                                    (typename create [])
                                  ]
                                  ())
                                [ (typename | []) ]
                                ())
                              [ (typename Empty []) ]
                              ())
                          ]
                          [
                            (select
                              ()
                              [ (typename break []) (typename create []) ]
                              ())
                          ])
                        (lambda
                          []
                          [
                            (select
                              (select
                                (select
                                  ()
                                  [
                                    (typename
                                      Continue
                                      [ (typeref [ (typename NoLabel []) ]) ])
                                    (typename create [])
                                  ]
                                  ())
                                [ (typename | []) ]
                                ())
                              [
                                (typename
                                  Continue
                                  [ (typeref [ (typename L []) ]) ])
                              ]
                              ())
                          ]
                          [ (select () [ (typename next []) ] (ref iter)) ])
                      ])
                  ]))
            ]))
        (using (typeref [ (modulename $module-2 []) ]))
        (using (typeref [ (modulename $module-3 []) ]))
        (class Empty [] () [])
        (interface
          Iterator
          [ (typeparam T () ()) ]
          ()
          [
            (function
              apply
              [ (typeparam S (isecttype [ (Self ) (mut ) ]) ()) ]
              [ (param self (typeref [ (typename S []) ]) ()) ]
              (uniontype
                [
                  (viewtype
                    (typeref [ (typename S []) ])
                    (typeref [ (typename T []) ]))
                  (throwtype (typeref [ (typename Empty []) ]))
                ])
              ())
            (function
              next
              []
              [ (param self (isecttype [ (Self ) (mut ) ]) ()) ]
              ()
              ())
            (function
              filter
              [
                (typeparam
                  S
                  (isecttype
                    [
                      (typeref
                        [
                          (typename Iterator [ (typeref [ (typename T []) ]) ])
                        ])
                      (mut )
                    ])
                  ())
                (typeparam
                  R
                  (isecttype
                    [
                      (typeref
                        [ (typename Filter [ (typeref [ (typename T []) ]) ]) ])
                      (mut )
                    ])
                  ())
              ]
              [
                (param
                  self
                  (viewtype
                    (typeref [ (typename R []) ])
                    (typeref [ (typename S []) ]))
                  ())
                (param
                  f
                  (functiontype
                    (viewtype
                      (viewtype
                        (typeref [ (typename R []) ])
                        (typeref [ (typename S []) ]))
                      (typeref [ (typename T []) ]))
                    (typeref [ (typename Bool []) ]))
                  ())
              ]
              (typeref [ (typename R []) ])
              (lambda
                []
                []
                [
                  (select
                    ()
                    [ (typename Filter []) ]
                    (tuple [ (ref self) (ref f) ]))
                ]))
          ])
        (class
          Repeat
          [ (typeparam T () ()) ]
          (typeref [ (typename Iterator [ (typeref [ (typename T []) ]) ]) ])
          [
            (field value (typeref [ (typename T []) ]) ())
            (function
              create
              [
                (typeparam
                  R
                  (typeref
                    [ (typename Repeat [ (typeref [ (typename T []) ]) ]) ])
                  ())
              ]
              [
                (param
                  value
                  (viewtype
                    (typeref [ (typename R []) ])
                    (typeref [ (typename T []) ]))
                  ())
              ]
              (typeref [ (typename R []) ])
              (lambda [] [] [ (new () (ref value)) ]))
            (function
              apply
              [
                (typeparam
                  S
                  (isecttype
                    [
                      (typeref
                        [ (typename Repeat [ (typeref [ (typename T []) ]) ]) ])
                      (mut )
                    ])
                  ())
              ]
              [ (param self (typeref [ (typename S []) ]) ()) ]
              (viewtype
                (typeref [ (typename S []) ])
                (typeref [ (typename T []) ]))
              (lambda [] [] [ (select (ref self) [ (typename value []) ] ()) ]))
            (function
              next
              []
              [
                (param
                  self
                  (isecttype
                    [
                      (typeref
                        [ (typename Repeat [ (typeref [ (typename T []) ]) ]) ])
                      (mut )
                    ])
                  ())
              ]
              ()
              (lambda [] [] []))
          ])
        (class
          Chain
          [ (typeparam T () ()) ]
          (typeref [ (typename Iterator [ (typeref [ (typename T []) ]) ]) ])
          [
            (field
              value
              (isecttype
                [
                  (typeref
                    [
                      (typename
                        Iterator
                        [
                          (isecttype
                            [
                              (typeref
                                [
                                  (typename
                                    Iterator
                                    [ (typeref [ (typename T []) ]) ])
                                ])
                              (mut )
                            ])
                        ])
                    ])
                  (mut )
                ])
              ())
            (function
              create
              [
                (typeparam
                  R
                  (typeref
                    [ (typename Chain [ (typeref [ (typename T []) ]) ]) ])
                  ())
              ]
              [
                (param
                  value
                  (viewtype
                    (typeref [ (typename R []) ])
                    (isecttype
                      [
                        (typeref
                          [
                            (typename
                              Iterator
                              [
                                (isecttype
                                  [
                                    (typeref
                                      [
                                        (typename
                                          Iterator
                                          [ (typeref [ (typename T []) ]) ])
                                      ])
                                    (mut )
                                  ])
                              ])
                          ])
                        (mut )
                      ]))
                  ())
              ]
              (typeref [ (typename R []) ])
              (lambda [] [] [ (new () (ref value)) ]))
            (function
              apply
              [
                (typeparam
                  S
                  (isecttype
                    [
                      (typeref
                        [ (typename Chain [ (typeref [ (typename T []) ]) ]) ])
                      (mut )
                    ])
                  ())
              ]
              [ (param self (typeref [ (typename S []) ]) ()) ]
              (uniontype
                [
                  (viewtype
                    (typeref [ (typename S []) ])
                    (typeref [ (typename T []) ]))
                  (throwtype (typeref [ (typename Empty []) ]))
                ])
              (lambda
                []
                []
                [
                  (select
                    (select () [ (typename value []) ] (tuple []))
                    [ (typename apply []) ]
                    (tuple []))
                ]))
            (function
              next
              []
              [
                (param
                  self
                  (isecttype
                    [
                      (typeref
                        [ (typename Chain [ (typeref [ (typename T []) ]) ]) ])
                      (mut )
                    ])
                  ())
              ]
              ()
              (lambda
                []
                []
                [
                  (select
                    ()
                    [ (typename value []) ]
                    (select (tuple []) [ (typename next []) ] (tuple [])))
                ]))
          ])
        (class
          Filter
          [ (typeparam T () ()) ]
          (typeref [ (typename Iterator [ (typeref [ (typename T []) ]) ]) ])
          [
            (field
              it
              (isecttype
                [
                  (typeref
                    [ (typename Iterator [ (typeref [ (typename T []) ]) ]) ])
                  (mut )
                ])
              ())
            (field
              f
              (functiontype
                (typeref [ (typename T []) ])
                (typeref [ (typename Bool []) ]))
              ())
            (field ok (typeref [ (typename Bool []) ]) ())
            (function
              create
              []
              [
                (param
                  it
                  (isecttype
                    [
                      (typeref
                        [
                          (typename Iterator [ (typeref [ (typename T []) ]) ])
                        ])
                      (mut )
                    ])
                  ())
                (param
                  f
                  (functiontype
                    (typeref [ (typename T []) ])
                    (typeref [ (typename Bool []) ]))
                  ())
              ]
              (isecttype
                [
                  (typeref
                    [ (typename Filter [ (typeref [ (typename T []) ]) ]) ])
                  (mut )
                ])
              (lambda
                []
                []
                [ (new () (tuple [ (ref it) (ref f) (false false) ])) ]))
            (function
              apply
              [
                (typeparam
                  S
                  (isecttype
                    [
                      (typeref
                        [ (typename Filter [ (typeref [ (typename T []) ]) ]) ])
                      (mut )
                    ])
                  ())
              ]
              [ (param self (typeref [ (typename S []) ]) ()) ]
              (uniontype
                [
                  (viewtype
                    (typeref [ (typename S []) ])
                    (typeref [ (typename T []) ]))
                  (throwtype (typeref [ (typename Empty []) ]))
                ])
              (lambda
                []
                []
                [
                  (select (ref self) [ (typename _advance []) ] (tuple []))
                  (select (ref self) [ (typename it []) ] (tuple []))
                ]))
            (function
              next
              []
              [
                (param
                  self
                  (isecttype
                    [
                      (typeref
                        [ (typename Filter [ (typeref [ (typename T []) ]) ]) ])
                      (mut )
                    ])
                  ())
              ]
              ()
              (lambda
                []
                []
                [
                  (select
                    (select (ref self) [ (typename it []) ] ())
                    [ (typename next []) ]
                    (tuple []))
                  (assign
                    (select (ref self) [ (typename ok []) ] ())
                    (false false))
                  (select (ref self) [ (typename _advance []) ] (tuple []))
                ]))
            (function
              _advance
              []
              [ (param self (isecttype [ (Self ) (mut ) ]) ()) ]
              ()
              (lambda
                []
                []
                [
                  (select
                    (select
                      ()
                      [ (typename if []) ]
                      (select
                        ()
                        [ (typename not []) ]
                        (select (ref self) [ (typename ok []) ] ())))
                    [ (typename apply []) ]
                    (lambda
                      []
                      []
                      [
                        (assign
                          (select (ref self) [ (typename ok []) ] ())
                          (true true))
                        (try
                          (lambda
                            []
                            []
                            [
                              (select
                                (select
                                  ()
                                  [ (typename while []) ]
                                  (lambda
                                    []
                                    []
                                    [
                                      (select
                                        ()
                                        [ (typename not []) ]
                                        (select
                                          (ref self)
                                          [ (typename f []) ]
                                          (select
                                            (ref self)
                                            [ (typename it []) ]
                                            (tuple []))))
                                    ]))
                                [ (typename apply []) ]
                                (lambda
                                  []
                                  []
                                  [
                                    (select
                                      (select
                                        (ref self)
                                        [ (typename it []) ]
                                        ())
                                      [ (typename next []) ]
                                      (tuple []))
                                  ]))
                            ])
                          [ (lambda [] [ (param Empty () ()) ] []) ])
                      ]))
                ]))
          ])
        (class
          Option
          [ (typeparam T () ()) ]
          (typeref [ (typename Iterator [ (typeref [ (typename T []) ]) ]) ])
          [
            (field
              v
              (uniontype
                [
                  (typeref [ (typename T []) ])
                  (typeref [ (typename None []) ])
                ])
              ())
            (function
              create
              [
                (typeparam
                  S
                  (typeref
                    [ (typename Option [ (typeref [ (typename T []) ]) ]) ])
                  ())
              ]
              [
                (param
                  v
                  (extracttype
                    (typeref [ (typename S []) ])
                    (typeref [ (typename T []) ]))
                  ())
              ]
              (typeref [ (typename S []) ])
              (lambda [] [] [ (new () (ref v)) ]))
            (function
              empty
              [
                (typeparam
                  S
                  (typeref
                    [ (typename Option [ (typeref [ (typename T []) ]) ]) ])
                  ())
              ]
              []
              (typeref [ (typename S []) ])
              (lambda
                []
                []
                [
                  (new
                    ()
                    (select () [ (typename None []) (typename create []) ] ()))
                ]))
            (function
              has_value
              []
              [
                (param
                  self
                  (typeref
                    [ (typename Option [ (typeref [ (typename T []) ]) ]) ])
                  ())
              ]
              (typeref [ (typename Bool []) ])
              (lambda
                []
                []
                [
                  (match
                    (select (ref self) [ (typename v []) ] ())
                    [
                      (lambda [] [ (param None () ()) ] [ (false false) ])
                      (lambda [] [] [ (true true) ])
                    ])
                ]))
            (function
              apply
              [
                (typeparam
                  S
                  (typeref
                    [ (typename Option [ (typeref [ (typename T []) ]) ]) ])
                  ())
              ]
              [ (param self (typeref [ (typename S []) ]) ()) ]
              (uniontype
                [
                  (viewtype
                    (typeref [ (typename S []) ])
                    (typeref [ (typename T []) ]))
                  (throwtype (typeref [ (typename Empty []) ]))
                ])
              (lambda
                []
                []
                [
                  (match
                    (select (ref self) [ (typename v []) ] ())
                    [
                      (lambda
                        []
                        [
                          (param
                            v
                            (viewtype
                              (typeref [ (typename S []) ])
                              (typeref [ (typename T []) ]))
                            ())
                        ]
                        [ (ref v) ])
                      (lambda
                        []
                        []
                        [
                          (throw
                            (select
                              ()
                              [ (typename Empty []) (typename create []) ]
                              ()))
                        ])
                    ])
                ]))
            (function
              value_or
              [
                (typeparam
                  S
                  (typeref
                    [ (typename Option [ (typeref [ (typename T []) ]) ]) ])
                  ())
                (typeparam U () ())
              ]
              [
                (param self (typeref [ (typename S []) ]) ())
                (param default (typeref [ (typename U []) ]) ())
              ]
              (uniontype
                [
                  (viewtype
                    (typeref [ (typename S []) ])
                    (typeref [ (typename T []) ]))
                  (typeref [ (typename U []) ])
                ])
              (lambda
                []
                []
                [
                  (match
                    (select (ref self) [ (typename v []) ] ())
                    [
                      (lambda
                        []
                        [
                          (param
                            v
                            (viewtype
                              (typeref [ (typename S []) ])
                              (typeref [ (typename T []) ]))
                            ())
                        ]
                        [ (ref v) ])
                      (lambda [] [] [ (ref default) ])
                    ])
                ]))
            (function
              extract
              [
                (typeparam
                  S
                  (isecttype
                    [
                      (typeref
                        [ (typename Option [ (typeref [ (typename T []) ]) ]) ])
                      (mut )
                    ])
                  ())
              ]
              [ (param self (typeref [ (typename S []) ]) ()) ]
              (uniontype
                [
                  (extracttype
                    (typeref [ (typename S []) ])
                    (typeref [ (typename T []) ]))
                  (throwtype (typeref [ (typename Empty []) ]))
                ])
              (lambda
                []
                []
                [
                  (match
                    (select (ref self) [ (typename v []) ] ())
                    [
                      (lambda
                        []
                        [
                          (param
                            v
                            (extracttype
                              (typeref [ (typename S []) ])
                              (typeref [ (typename T []) ]))
                            ())
                        ]
                        [
                          (assign
                            (select (ref self) [ (typename v []) ] ())
                            (select
                              ()
                              [ (typename None []) (typename create []) ]
                              ()))
                        ])
                      (lambda
                        []
                        []
                        [
                          (throw
                            (select
                              ()
                              [ (typename Empty []) (typename create []) ]
                              ()))
                        ])
                    ])
                ]))
            (function
              extract_or
              [
                (typeparam
                  S
                  (isecttype
                    [
                      (typeref
                        [ (typename Option [ (typeref [ (typename T []) ]) ]) ])
                      (mut )
                    ])
                  ())
                (typeparam U () ())
              ]
              [
                (param self (typeref [ (typename S []) ]) ())
                (param default (typeref [ (typename U []) ]) ())
              ]
              (uniontype
                [
                  (extracttype
                    (typeref [ (typename S []) ])
                    (typeref [ (typename T []) ]))
                  (typeref [ (typename U []) ])
                ])
              (lambda
                []
                []
                [
                  (match
                    (select (ref self) [ (typename v []) ] ())
                    [
                      (lambda
                        []
                        [
                          (param
                            v
                            (extracttype
                              (typeref [ (typename S []) ])
                              (typeref [ (typename T []) ]))
                            ())
                        ]
                        [
                          (assign
                            (select (ref self) [ (typename v []) ] ())
                            (select
                              ()
                              [ (typename None []) (typename create []) ]
                              ()))
                        ])
                      (lambda [] [] [ (ref default) ])
                    ])
                ]))
          ])
      ])
    (class
      $module-2
      []
      ()
      [
        (class
          Bool
          []
          ()
          [
            (function
              apply
              []
              [ (param self (typeref [ (typename Bool []) ]) ()) ]
              (typeref [ (typename Bool []) ])
              (lambda [] [] [ (ref self) ]))
            (function
              bool
              []
              [ (param self (typeref [ (typename Bool []) ]) ()) ]
              (typeref [ (typename Bool []) ])
              (lambda [] [] [ (ref self) ]))
          ])
        (interface
          ToBool
          []
          ()
          [
            (function
              bool
              []
              [ (param self (Self ) ()) ]
              (typeref [ (typename Bool []) ])
              ())
          ])
        (function
          and
          [
            (typeparam T (typeref [ (typename ToBool []) ]) ())
            (typeparam U () ())
          ]
          [
            (param a (typeref [ (typename T []) ]) ())
            (param
              b
              (functiontype (tupletype []) (typeref [ (typename U []) ]))
              ())
          ]
          (uniontype
            [ (typeref [ (typename T []) ]) (typeref [ (typename U []) ]) ])
          (lambda
            []
            []
            [
              (match
                (select () [ (typename bool []) ] (ref a))
                [
                  (lambda [] [ (false false) ] [ (ref a) ])
                  (lambda
                    []
                    [ (true true) ]
                    [ (select (ref b) [ (typename apply []) ] (tuple [])) ])
                ])
            ]))
        (function
          or
          [
            (typeparam T (typeref [ (typename ToBool []) ]) ())
            (typeparam U () ())
          ]
          [
            (param a (typeref [ (typename T []) ]) ())
            (param
              b
              (functiontype (tupletype []) (typeref [ (typename U []) ]))
              ())
          ]
          (uniontype
            [ (typeref [ (typename T []) ]) (typeref [ (typename U []) ]) ])
          (lambda
            []
            []
            [
              (match
                (select () [ (typename bool []) ] (ref a))
                [
                  (lambda [] [ (true true) ] [ (ref a) ])
                  (lambda
                    []
                    [ (false false) ]
                    [ (select (ref b) [ (typename apply []) ] (tuple [])) ])
                ])
            ]))
        (function
          not
          [ (typeparam T (typeref [ (typename ToBool []) ]) ()) ]
          [ (param a (typeref [ (typename T []) ]) ()) ]
          (typeref [ (typename Bool []) ])
          (lambda
            []
            []
            [
              (match
                (select () [ (typename bool []) ] (ref a))
                [
                  (lambda [] [ (true true) ] [ (false false) ])
                  (lambda [] [ (false false) ] [ (true true) ])
                ])
            ]))
        (class Less [] () [])
        (class Equal [] () [])
        (class Greater [] () [])
        (typealias
          Compare
          []
          (uniontype
            [
              (typeref [ (typename Less []) ])
              (typeref [ (typename Equal []) ])
              (typeref [ (typename Greater []) ])
            ]))
        (interface
          Equatable
          [ (typeparam T () ()) ]
          ()
          [
            (function
              ==
              []
              [
                (param self (Self ) ())
                (param other (typeref [ (typename T []) ]) ())
              ]
              (typeref [ (typename Bool []) ])
              ())
            (function
              !=
              []
              [
                (param self (Self ) ())
                (param other (typeref [ (typename T []) ]) ())
              ]
              (typeref [ (typename Bool []) ])
              (lambda
                []
                []
                [
                  (select
                    ()
                    [ (typename not []) ]
                    (select (ref self) [ (typename == []) ] (ref other)))
                ]))
          ])
        (interface
          Comparable
          [ (typeparam T () ()) ]
          (typeref [ (typename Equatable [ (typeref [ (typename T []) ]) ]) ])
          [
            (function
              <
              []
              [
                (param self (Self ) ())
                (param other (typeref [ (typename T []) ]) ())
              ]
              (typeref [ (typename Bool []) ])
              ())
            (function
              <=
              []
              [
                (param self (Self ) ())
                (param other (typeref [ (typename T []) ]) ())
              ]
              (typeref [ (typename Bool []) ])
              (lambda
                []
                []
                [
                  (select
                    (select (ref self) [ (typename < []) ] (ref other))
                    [ (typename or []) ]
                    (select (ref self) [ (typename == []) ] (ref other)))
                ]))
            (function
              >=
              []
              [
                (param self (Self ) ())
                (param other (typeref [ (typename T []) ]) ())
              ]
              (typeref [ (typename Bool []) ])
              (lambda
                []
                []
                [
                  (select
                    ()
                    [ (typename not []) ]
                    (select (ref self) [ (typename < []) ] (ref other)))
                ]))
            (function
              >
              []
              [
                (param self (Self ) ())
                (param other (typeref [ (typename T []) ]) ())
              ]
              (typeref [ (typename Bool []) ])
              (lambda
                []
                []
                [
                  (select
                    ()
                    [ (typename not []) ]
                    (select (ref self) [ (typename <= []) ] (ref other)))
                ]))
            (function
              <=>
              []
              [
                (param self (Self ) ())
                (param other (typeref [ (typename T []) ]) ())
              ]
              (typeref [ (typename Compare []) ])
              (lambda
                []
                []
                [
                  (select
                    (select
                      (select
                        (select
                          (select
                            ()
                            [ (typename if []) ]
                            (select (ref self) [ (typename < []) ] (ref other)))
                          [ (typename apply []) ]
                          (lambda
                            []
                            []
                            [
                              (select
                                ()
                                [ (typename Less []) (typename create []) ]
                                ())
                            ]))
                        [ (typename elseif []) ]
                        (select (ref self) [ (typename == []) ] (ref other)))
                      [ (typename apply []) ]
                      (lambda
                        []
                        []
                        [
                          (select
                            ()
                            [ (typename Equal []) (typename create []) ]
                            ())
                        ]))
                    [ (typename else []) ]
                    (lambda
                      []
                      []
                      [
                        (select
                          ()
                          [ (typename Greater []) (typename create []) ]
                          ())
                      ]))
                ]))
          ])
      ])
    (class
      $module-3
      []
      ()
      [
        (function
          ~
          [
            (typeparam T () ())
            (typeparam U () ())
            (typeparam V () ())
            (typeparam
              R
              (functiontype
                (typeref [ (typename U []) ])
                (typeref [ (typename V []) ]))
              ())
          ]
          [
            (param
              f
              (viewtype
                (typeref [ (typename R []) ])
                (functiontype
                  (tupletype
                    [
                      (typeref [ (typename T []) ])
                      (typeref [ (typename U []) ])
                    ])
                  (typeref [ (typename V []) ])))
              ())
            (param
              x
              (viewtype
                (typeref [ (typename R []) ])
                (typeref [ (typename T []) ]))
              ())
          ]
          (typeref [ (typename R []) ])
          (lambda
            []
            []
            [
              (lambda
                []
                [ (param y () ()) ]
                [
                  (select
                    (ref f)
                    [ (typename apply []) ]
                    (tuple [ (ref x) (ref y) ]))
                ])
            ]))
        (function
          |>
          [ (typeparam T () ()) (typeparam U () ()) ]
          [
            (param x (typeref [ (typename T []) ]) ())
            (param
              y
              (functiontype
                (typeref [ (typename T []) ])
                (typeref [ (typename U []) ]))
              ())
          ]
          (typeref [ (typename U []) ])
          (lambda [] [] [ (select (ref y) [ (typename apply []) ] (ref x)) ]))
        (class FalseBranch [] () [])
        (class
          if
          []
          ()
          [
            (function
              apply
              [ (typeparam T () ()) ]
              [
                (param
                  cond
                  (functiontype (tupletype []) (typeref [ (typename Bool []) ]))
                  ())
              ]
              (functiontype
                (functiontype (tupletype []) (typeref [ (typename T []) ]))
                (uniontype
                  [
                    (typeref
                      [ (typename Done [ (typeref [ (typename T []) ]) ]) ])
                    (typeref [ (typename FalseBranch []) ])
                  ]))
              (lambda
                []
                []
                [
                  (lambda
                    []
                    [ (param ontrue () ()) ]
                    [
                      (match
                        (select (ref cond) [ (typename apply []) ] (tuple []))
                        [
                          (lambda
                            []
                            [ (true true) ]
                            [
                              (select
                                ()
                                [ (typename Done []) ]
                                (select
                                  (ref ontrue)
                                  [ (typename apply []) ]
                                  (tuple [])))
                            ])
                          (lambda
                            []
                            [ (false false) ]
                            [
                              (select
                                ()
                                [
                                  (typename FalseBranch [])
                                  (typename create [])
                                ]
                                ())
                            ])
                        ])
                    ])
                ]))
          ])
        (function
          elseif
          [ (typeparam T () ()) (typeparam U () ()) ]
          [
            (param
              prev
              (uniontype
                [
                  (typeref
                    [ (typename Done [ (typeref [ (typename T []) ]) ]) ])
                  (typeref [ (typename FalseBranch []) ])
                ])
              ())
            (param
              cond
              (functiontype (tupletype []) (typeref [ (typename Bool []) ]))
              ())
          ]
          (functiontype
            (functiontype (tupletype []) (typeref [ (typename U []) ]))
            (uniontype
              [
                (typeref [ (typename Done [ (typeref [ (typename T []) ]) ]) ])
                (typeref [ (typename Done [ (typeref [ (typename U []) ]) ]) ])
              ]))
          (lambda
            []
            []
            [
              (lambda
                []
                [ (param ontrue () ()) ]
                [
                  (select
                    (ref prev)
                    [ (typename else []) ]
                    (lambda
                      []
                      []
                      [
                        (select
                          (select () [ (typename if []) ] (ref cond))
                          [ (typename apply []) ]
                          (ref ontrue))
                      ]))
                ])
            ]))
        (function
          else
          [ (typeparam T () ()) (typeparam U () ()) ]
          [
            (param
              prev
              (uniontype
                [
                  (typeref
                    [ (typename Done [ (typeref [ (typename T []) ]) ]) ])
                  (typeref [ (typename FalseBranch []) ])
                ])
              ())
            (param
              onfalse
              (functiontype (tupletype []) (typeref [ (typename U []) ]))
              ())
          ]
          (uniontype
            [
              (typeref [ (typename Done [ (typeref [ (typename T []) ]) ]) ])
              (typeref [ (typename Done [ (typeref [ (typename U []) ]) ]) ])
            ])
          (lambda
            []
            []
            [
              (match
                (ref prev)
                [
                  (lambda
                    []
                    [
                      (select
                        ()
                        [ (typename FalseBranch []) (typename create []) ]
                        ())
                    ]
                    [
                      (select
                        ()
                        [ (typename Done []) ]
                        (select
                          (ref onfalse)
                          [ (typename apply []) ]
                          (tuple [])))
                    ])
                  (lambda
                    []
                    [
                      (param
                        v
                        (typeref
                          [ (typename Done [ (typeref [ (typename T []) ]) ]) ])
                        ())
                    ]
                    [ (ref v) ])
                ])
            ]))
        (using (typeref [ (modulename $module-2 []) ]))
        (interface Any [] () [])
        (class None [] () [])
        (class NoCatch [] () [])
        (class
          Done
          [ (typeparam T () ()) ]
          ()
          [
            (field result (typeref [ (typename T []) ]) ())
            (function
              create
              [
                (typeparam
                  R
                  (typeref
                    [ (typename Done [ (typeref [ (typename T []) ]) ]) ])
                  ())
              ]
              [
                (param
                  from
                  (viewtype
                    (typeref [ (typename R []) ])
                    (typeref [ (typename T []) ]))
                  ())
              ]
              (typeref [ (typename R []) ])
              (lambda [] [] [ (new () (ref from)) ]))
            (function
              apply
              [ (typeparam U () ()) ]
              [ (param x (typeref [ (typename U []) ]) ()) ]
              (typeref [ (typename U []) ])
              (lambda [] [] [ (ref x) ]))
          ])
        (class NoLabel [] () [])
        (class Break [ (typeparam L () ()) ] () [])
        (class Continue [ (typeparam L () ()) ] () [])
        (class
          break
          [ (typeparam L () (typeref [ (typename NoLabel []) ])) ]
          ()
          [
            (function
              create
              []
              []
              (throwtype
                (typeref [ (typename Break [ (typeref [ (typename L []) ]) ]) ]))
              (lambda
                []
                []
                [
                  (throw
                    (select
                      ()
                      [
                        (typename Break [ (typeref [ (typename L []) ]) ])
                        (typename create [])
                      ]
                      ()))
                ]))
          ])
        (class
          continue
          [ (typeparam L () (typeref [ (typename NoLabel []) ])) ]
          ()
          [
            (function
              create
              []
              []
              (throwtype
                (typeref
                  [ (typename Continue [ (typeref [ (typename L []) ]) ]) ]))
              (lambda
                []
                []
                [
                  (throw
                    (select
                      ()
                      [
                        (typename Continue [ (typeref [ (typename L []) ]) ])
                        (typename create [])
                      ]
                      ()))
                ]))
          ])
        (function
          while
          [
            (typeparam L () (typeref [ (typename NoLabel []) ]))
            (typeparam T () ())
            (typeparam U () ())
          ]
          [
            (param
              cond
              (functiontype (tupletype []) (typeref [ (typename Bool []) ]))
              ())
            (param
              body
              (functiontype
                (tupletype [])
                (uniontype
                  [
                    (typeref [ (typename T []) ])
                    (throwtype (typeref [ (typename U []) ]))
                  ]))
              ())
          ]
          (uniontype
            [
              (typeref [ (typename Done [ (typeref [ (typename None []) ]) ]) ])
              (throwtype (typeref [ (typename U []) ]))
            ])
          (lambda
            []
            []
            [
              (match
                (select (ref cond) [ (typename apply []) ] (tuple []))
                [
                  (lambda
                    []
                    [ (true true) ]
                    [
                      (try
                        (lambda
                          []
                          []
                          [
                            (select
                              (ref body)
                              [ (typename apply []) ]
                              (tuple []))
                            (select
                              ()
                              [ (typename continue []) (typename create []) ]
                              ())
                          ])
                        [
                          (lambda
                            []
                            [
                              (select
                                (select
                                  (select
                                    ()
                                    [
                                      (typename
                                        Break
                                        [ (typeref [ (typename NoLabel []) ]) ])
                                      (typename create [])
                                    ]
                                    ())
                                  [ (typename | []) ]
                                  ())
                                [
                                  (typename
                                    Break
                                    [ (typeref [ (typename L []) ]) ])
                                ]
                                ())
                            ]
                            [
                              (select
                                ()
                                [ (typename Done []) ]
                                (select
                                  ()
                                  [ (typename None []) (typename create []) ]
                                  ()))
                            ])
                          (lambda
                            []
                            [
                              (select
                                (select
                                  (select
                                    ()
                                    [
                                      (typename
                                        Continue
                                        [ (typeref [ (typename NoLabel []) ]) ])
                                      (typename create [])
                                    ]
                                    ())
                                  [ (typename | []) ]
                                  ())
                                [
                                  (typename
                                    Continue
                                    [ (typeref [ (typename L []) ]) ])
                                ]
                                ())
                            ]
                            [
                              (select
                                (select
                                  ()
                                  [
                                    (typename
                                      while
                                      [ (typeref [ (typename L []) ]) ])
                                  ]
                                  (ref cond))
                                [ (typename apply []) ]
                                (ref body))
                            ])
                        ])
                    ])
                  (lambda [] [] [])
                ])
            ]))
        (class NoMatch [] () [])
        (function
          as
          [ (typeparam T () ()) (typeparam U () ()) ]
          [ (param value (typeref [ (typename U []) ]) ()) ]
          (uniontype
            [
              (typeref [ (typename T []) ])
              (throwtype (typeref [ (typename NoMatch []) ]))
            ])
          (lambda
            []
            []
            [
              (match
                (ref value)
                [
                  (lambda
                    []
                    [ (param x (typeref [ (typename T []) ]) ()) ]
                    [ (ref x) ])
                  (lambda
                    []
                    []
                    [
                      (throw
                        (select
                          ()
                          [ (typename NoMatch []) (typename create []) ]
                          ()))
                    ])
                ])
            ]))
        (function
          requires
          []
          [ (param pred (typeref [ (typename Bool []) ]) ()) ]
          (throwtype (typeref [ (typename NoMatch []) ]))
          (lambda
            []
            []
            [
              (select
                (select
                  ()
                  [ (typename if []) ]
                  (select () [ (typename not []) ] (ref pred)))
                [ (typename apply []) ]
                (lambda
                  []
                  []
                  [
                    (throw
                      (select
                        ()
                        [ (typename NoMatch []) (typename create []) ]
                        ()))
                  ]))
            ]))
        (class
          OrEquals
          [ (typeparam T1 () ()) (typeparam T2 () ()) ]
          ()
          [
            (field
              a
              (typeref
                [ (typename Equatable [ (typeref [ (typename T1 []) ]) ]) ])
              ())
            (field
              b
              (typeref
                [ (typename Equatable [ (typeref [ (typename T2 []) ]) ]) ])
              ())
            (function
              ==
              []
              [
                (param
                  self
                  (typeref
                    [
                      (typename
                        OrEquals
                        [
                          (typeref [ (typename T1 []) ])
                          (typeref [ (typename T2 []) ])
                        ])
                    ])
                  ())
                (param
                  x
                  (uniontype
                    [
                      (typeref [ (typename T1 []) ])
                      (typeref [ (typename T2 []) ])
                    ])
                  ())
              ]
              (typeref [ (typename Bool []) ])
              (lambda
                []
                []
                [
                  (match
                    (ref x)
                    [
                      (lambda
                        []
                        [ (param y (typeref [ (typename T1 []) ]) ()) ]
                        [
                          (select
                            (select (ref self) [ (typename a []) ] ())
                            [ (typename == []) ]
                            (ref y))
                        ])
                      (lambda
                        []
                        [ (param y (typeref [ (typename T2 []) ]) ()) ]
                        [
                          (select
                            (select (ref self) [ (typename b []) ] ())
                            [ (typename == []) ]
                            (ref y))
                        ])
                      (lambda [] [] [ (false false) ])
                    ])
                ]))
          ])
        (function
          |
          [ (typeparam T1 () ()) (typeparam T2 () ()) ]
          [
            (param
              e1
              (typeref
                [ (typename Equatable [ (typeref [ (typename T1 []) ]) ]) ])
              ())
            (param
              e2
              (typeref
                [ (typename Equatable [ (typeref [ (typename T2 []) ]) ]) ])
              ())
          ]
          (typeref
            [
              (typename
                OrEquals
                [
                  (typeref [ (typename T1 []) ])
                  (typeref [ (typename T2 []) ])
                ])
            ])
          (lambda
            []
            []
            [
              (select
                ()
                [ (typename OrEquals []) ]
                (tuple [ (ref e1) (ref e2) ]))
            ]))
        (class
          Return
          [ (typeparam T () ()) ]
          ()
          [ (field value (typeref [ (typename T []) ]) ()) ])
        (class
          return
          [ (typeparam T () (typeref [ (typename None []) ])) ]
          ()
          [
            (function
              create
              []
              [
                (param
                  x
                  (typeref [ (typename T []) ])
                  (lambda
                    []
                    []
                    [
                      (select () [ (typename None []) (typename create []) ] ())
                    ]))
              ]
              (throwtype
                (typeref
                  [ (typename Return [ (typeref [ (typename T []) ]) ]) ]))
              (lambda
                []
                []
                [
                  (throw
                    (select
                      ()
                      [ (typename Return [ (typeref [ (typename T []) ]) ]) ]
                      (ref x)))
                ]))
          ])
      ])
  ])
