include(${CMAKE_CURRENT_LIST_DIR}/common.cmake)

PrepareTest(VERONAC_FLAGS EXPECTED_DUMP ACTUAL_DUMP)

set(AST_DUMP_FILE ${CMAKE_CURRENT_BINARY_DIR}/${TEST_NAME}.output)

CheckStatus(
  COMMAND ${PARSER} -a -g ${GRAMMAR} ${TEST_FILE}
  EXPECTED_STATUS 0
  OUTPUT_FILE ${AST_DUMP_FILE})

file(READ ${AST_DUMP_FILE} AST_DUMP)
message(STATUS ${AST_DUMP})

FileCheck(${TEST_FILE} ${AST_DUMP_FILE})
